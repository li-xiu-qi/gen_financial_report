"""
提示词模板和常量定义
"""

# 可视化增强内容生成提示词模板
VISUALIZATION_ENHANCEMENT_PROMPT_TEMPLATE = """# 可视化增强内容生成任务

你是一位资深的金融分析师，需要基于原始分析内容和提供的图表资源，生成一份更深入、更有说服力的专业研究报告。

## 原始分析内容
{original_content}

## 可用图表资源
以下图表包含丰富的数据和洞察，请根据实际提供的图表情况进行分析：

{chart_resources}

## 图表使用重要原则（强制遵守）

### ⚠️ 图表引用约束（绝对禁止违反）
1. **仅用提供图表**：只能使用上方"可用图表资源"中明确提供且有有效PNG路径的图表
2. **路径验证要求**：只有当PNG图片绝对路径不为空且真实存在时，才可以引用该图表
3. **禁止虚构图片**：严禁创造、编造、想象任何图片路径！绝不可引用未提供的图表
4. **禁止占位符**：严禁使用"绝对路径"、"[图片路径]"等占位符，只能使用真实的完整路径
5. **Markdown语法**：引用图表时必须使用 `![图表标题](完整绝对路径)` 格式
6. **禁止错误格式**：严禁使用 "**图X：标题**" 格式，这不会显示图片
7. **自然嵌入**：图表要在分析过程中自然嵌入，不要集中在最后统一放置

### 📈 内容重写策略
1. **基于图表重写**：当有可用图表时，基于图表数据重新组织和深化分析内容
2. **数据驱动分析**：利用图表中的具体数据来支撑和强化分析观点
3. **避免简单复制**：不要简单复制原始内容，要基于图表内容进行重新阐述
4. **增加分析深度**：为每个引用的图表提供2-3段深入的数据解读
5. **创建分析小节**：可以为重要图表创建独立的小标题进行专门分析

### 🎯 正确的图表使用方式
**正确示例**：
```
### 财务表现对比分析

通过对比两家公司的关键财务指标，我们发现显著的差异：

![4Paradigm与旷视科技财务主要指标对比](C:/Users/ke/Documents/projects/python_projects/gen_report/test_company_datas/images/chart_1.png)

从上图数据可以看出，4Paradigm在营收增长率方面表现突出，达到45.2%，显著超过旷视科技的28.7%。这一差异主要源于...
```

**错误示例**（绝不可以这样写）：
```
**图1：4Paradigm与旷视科技财务主要指标对比**  ← 错误：不会显示图片
![某图表](绝对路径)  ← 错误：使用占位符
![图表](./images/chart.png)  ← 错误：虚构路径
```

### 📝 写作原则
1. **按需引用图表**：只有当章节确实有可用的图表资源时，才在分析中引用图表
2. **无图表时正常分析**：如果没有提供相关图表，正常基于数据进行文字分析，不要尝试引用图表
3. **重写而非追加**：基于图表内容重新组织分析逻辑，而不是简单在原内容后面追加图表
4. **自然融合**：图表要在分析过程中自然出现，支撑具体的分析观点
5. **深度解读**：每个图表都要有详细的数据解读和投资启示

### 📊 内容组织策略
1. **分段式分析**：将原内容重新组织为多个分析段落，在合适位置插入图表
2. **数据驱动重写**：利用图表数据重新阐述分析观点，增加数据支撑
3. **创建专题分析**：为重要图表创建专门的分析小节（如"### 财务指标对比分析"）
4. **逻辑重构**：基于可用图表重新构建分析逻辑框架
5. **避免图表堆积**：不要把所有图表集中在内容最后，要分散在分析过程中

## 强制要求总结
- **图表验证**：只使用有真实PNG路径的图表，路径为空或无效的图表不能引用
- **Markdown语法**：必须使用 `![标题](完整绝对路径)` 格式
- **禁止虚构**：严禁编造任何图片路径或图表引用
- **自然嵌入**：在分析过程中自然嵌入图表，不要集中放置
- **深度解读**：每个图表后必须有详细的数据分析
- **重写内容**：基于图表重新组织内容，不是简单复制粘贴

## 输出要求
请基于原始内容和可用的图表资源，生成一份重新组织的分析内容：

### 📊 图表使用要求
- **按需使用**：只有当提供了有效PNG路径的图表时，才在内容中引用
- **验证路径**：确保每个引用的图表都有真实完整的绝对路径
- **Markdown嵌入**：使用 `![图表标题](完整绝对路径)` 格式嵌入图表
- **自然分布**：在分析过程中自然嵌入图表，不要集中在最后
- **深度解读**：每个图表后提供2-3段详细的数据解读分析

### 📝 内容质量要求
- **重新组织**：基于图表数据重新组织分析框架，不是简单追加
- **数据驱动**：充分利用图表中的具体数据支撑分析观点
- **专业深度**：提供专业的投资洞察和风险分析
- **逻辑清晰**：确保分析逻辑清晰，图表与文字自然衔接
- **字数增加**：目标字数比原内容增加50-100%

### 🚨 严格禁止
1. **禁止虚构图表**：绝不可编造、想象任何图片路径
2. **禁止占位符**：禁止使用"绝对路径"、"[图片路径]"等占位符
3. **禁止错误格式**：禁止使用"**图X：标题**"格式
4. **禁止集中放置**：禁止把图表集中在内容最后统一放置
5. **禁止无效引用**：禁止引用路径为空或不存在的图表

开始基于可用图表资源重新组织和生成内容：
"""

# 单个图表资源模板
CHART_RESOURCE_TEMPLATE = """### 图表{chart_number}：{chart_title}
- **图表类型**：{chart_type}
- **分析价值**：{report_value}
- **PNG图片路径状态**：{path_status}
{path_info}
- **HTML文件路径**：{absolute_html_path}
{chart_usage_instruction}
- **详细图表描述与数据洞察**：
{image_description}

**HTML图表代码（用于数据分析参考）**：
```html
{html_content}
```
"""

# 图表使用强制要求常量
CHART_USAGE_REQUIREMENTS = """
**🚨 图表使用强制要求：**
- **必须嵌入**：每个图表都必须使用Markdown语法嵌入到内容中
- **禁止格式**：绝对不可以只写'**图X：标题**'这样的格式
- **正确格式**：必须使用 `![图表标题](绝对路径)` 格式
- **路径要求**：必须使用PNG图片的绝对路径确保图片正确显示
- **🚫 严禁虚构**：严禁创造、编造、想象任何图片路径或图表内容
- **仅限提供**：只能使用上方明确提供的图表，不得引用任何未提供的图表
- **路径精确**：必须完全复制提供的绝对路径，不可修改或简化
- **解读要求**：结合图表的详细描述进行深入分析和解读
- **支撑作用**：图表应该用来支撑和强化你的分析观点
- **数据参考**：可以参考HTML图表代码了解图表的具体数据源和配置信息
- **完整数据**：HTML代码中包含了完整的数据数组和图表配置，可用于数据分析
"""

# 基于文本的可视化查询模板
TEXT_VISUALIZATION_QUERY_TEMPLATE = """
基于以下章节内容，为{target_name}的{section_title}生成一个专业的金融分析图表：

章节内容：
{section_content}

要求：
1. 图表标题要体现{target_name}和{section_title}的关系
2. 尽量从内容中提取具体的数据、比例、趋势等进行可视化
3. 如果内容中有对比信息，优先制作对比图表
4. 如果内容中有时间序列信息，可制作趋势图
5. 如果内容中有分类信息，可制作饼图或柱状图
6. 确保图表能够支撑和增强该章节的分析观点
7. 图表要符合专业研究报告的风格
8. 背景色使用白色，确保可以清晰截图

请生成一个静态的、可直接截图的HTML图表。
"""
